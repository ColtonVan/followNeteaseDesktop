{"version":3,"sources":["webpack:///./src/layout/container/videoDetail.vue","webpack:///./src/api/common.ts","webpack:///./src/layout/container/videoDetail.vue?54d4","webpack:///./src/layout/container/videoDetail.vue?7655","webpack:///./src/layout/container/videoDetail.vue?8b7f"],"names":["class","$router","back","color","width","height","controls","poster","videoDetail","coverUrl","src","videoUrls","length","url","style","creator","nickname","userFollows","map","item","userId","includes","followUser","title","YYYYMMDD","publishTime","playCount","videoGroup","key","id","name","videoDetailInfo","liked","likeMV","praisedCount","collectedMVList","vid","collectMV","subscribeCount","shareCount","recommendVideoList","index","data","playTime","visible","modalVisible","okCollection","ref","params","get","timeStamp","Date","now","setup","route","state","videoId","query","commonToast","likedMVList","getVideoDetail","Promise","resolve","reject","then","res","code","getVideoDetailInfo","getVideoUrl","urls","getUserFollows","follow","isFocus","t","success","getLikedMV","feeds","isLiked","warn","msg","getCollectedMV","getRecommendVideo","datas","isCollected","render","__scopeId"],"mappings":"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","file":"js/chunk-31e91c84.c9fd0f9b.js","sourcesContent":["<template>\r\n    <div class=\"row h-100 flex-center\">\r\n        <div class=\"h-100 layoutWidth overflow-scroll hideScrollBar d-flex justify-content-between\">\r\n            <div class=\"leftArea pe-5\">\r\n                <div class=\"d-flex align-items-center py-3 cursor-pointer\" @click=\"$router.back()\">\r\n                    <arrow-left-icon color=\"#000000\" width=\"18px\" height=\"18px\" />\r\n                    <span class=\"ms-3 fs-4\">视频详情</span>\r\n                </div>\r\n                <video controls :poster=\"videoDetail.coverUrl\" :src=\"videoUrls && videoUrls.length ? videoUrls[0].url : ''\" />\r\n                <div class=\"mt-3 d-flex align-items-center justify-content-between\">\r\n                    <div class=\"d-flex align-items-center\">\r\n                        <div :style=\"{ backgroundImage: `url(&quot;${videoDetail.avatarUrl}&quot;)` }\" class=\"videoAvatar rounded-pill me-3\" />\r\n                        <div class=\"text-muted canSelect\">{{ videoDetail?.creator?.nickname }}</div>\r\n                    </div>\r\n\r\n                    <div\r\n                        v-if=\"userFollows.map(item => item.userId).includes(videoDetail?.creator?.userId)\"\r\n                        class=\"haveFocus text-muted cursor-pointer text-dark px-4 py-2 rounded-pill flex-center\"\r\n                        @click=\"followUser(false)\"\r\n                    >\r\n                        √已关注\r\n                    </div>\r\n                    <div v-else class=\"focus cursor-pointer text-dark px-4 py-2 rounded-pill flex-center\" @click=\"followUser(true)\">\r\n                        + 关注\r\n                    </div>\r\n                </div>\r\n                <div class=\"fs-4 fw-bold mt-4\">{{ videoDetail.title }}</div>\r\n                <div class=\"mt-3 text-muted opacity-50\">\r\n                    <span class=\"me-5\">发布：{{ YYYYMMDD(videoDetail.publishTime) }}</span>\r\n                    <span v-if=\"videoDetail.playCount\">播放：{{ playCount(videoDetail.playCount) }}次</span>\r\n                </div>\r\n                <div class=\"d-flex mt-4 flex-wrap\">\r\n                    <div class=\"groupTag rounded-pill px-3\" v-for=\"item in videoDetail.videoGroup\" :key=\"item.id\">{{ item.name }}</div>\r\n                </div>\r\n                <div class=\"mt-6 d-flex justify-content-start mt-4\">\r\n                    <div\r\n                        v-if=\"videoDetailInfo.liked\"\r\n                        @click=\"likeMV(false)\"\r\n                        class=\"px-4 py-2 border border-1 rounded-pill cursor-pointer opBtn flex-center\"\r\n                    >\r\n                        <PraiseIcon width=\"14px\" height=\"14px\" class=\"me-2 translate-y--10\" color=\"red\" />已赞({{\r\n                            playCount(videoDetail.praisedCount)\r\n                        }})\r\n                    </div>\r\n                    <div v-else @click=\"likeMV(true)\" class=\"px-4 py-2 border border-1 rounded-pill cursor-pointer opBtn flex-center\">\r\n                        <PraiseIcon width=\"14px\" height=\"14px\" class=\"me-2 translate-y--10\" />赞({{ playCount(videoDetail.praisedCount) }})\r\n                    </div>\r\n\r\n                    <div\r\n                        v-if=\"collectedMVList.map(item => item.vid).includes(videoDetail.vid)\"\r\n                        @click=\"collectMV(false)\"\r\n                        class=\"px-4 py-2 border border-1 rounded-pill cursor-pointer opBtn flex-center\"\r\n                    >\r\n                        <CollectBoxIcon color=\"red\" width=\"16px\" height=\"16px\" class=\"me-2\" />已收藏({{ playCount(videoDetail.subscribeCount) }})\r\n                    </div>\r\n                    <div v-else @click=\"collectMV(true)\" class=\"px-4 py-2 border border-1 rounded-pill cursor-pointer opBtn flex-center\">\r\n                        <CollectBoxIcon width=\"16px\" height=\"16px\" class=\"me-2\" />收藏({{ playCount(videoDetail.subscribeCount) }})\r\n                    </div>\r\n\r\n                    <div class=\"px-4 py-2 border border-1 rounded-pill cursor-pointer opBtn flex-center\">\r\n                        <ShareIcon width=\"16px\" height=\"16px\" class=\"me-2\" />分享({{ playCount(videoDetail.shareCount) }})\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"rightArea flex-grow-1 flex-shrink-0\">\r\n                <div class=\"fs-4 py-3\">相关推荐</div>\r\n                <div v-for=\"(item, index) in recommendVideoList\" :key=\"index\" class=\"overflow-hidden rounded-3 mb-3 d-flex cursor-pointer\">\r\n                    <div class=\"recVideoCover bg-base text-white position-relative overflow-hidden rounded-3\" :style=\"{ backgroundImage: `url(${item.data.coverUrl})` }\">\r\n                        <div class=\"position-absolute top-0 end-0 pe-1 pt-1 d-flex align-items-center\">\r\n                            <hollow-play-icon width=\"11px\" height=\"11px\" class=\"translate-y--20\"/>\r\n                            <span class=\"ms-1\">{{ playCount(item.data.praisedCount) }}</span>\r\n                        </div>\r\n                        <div class=\"position-absolute bottom-0 end-0 pe-1 pb-1\">\r\n                            {{ playTime(item.data.playTime) }}\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"ms-3 recVideoInfo d-flex flex-column justify-content-center\">\r\n                        <div class=\"mb-2 fs-5\">{{ item.data.title }}</div>\r\n                        <div class=\"text-muted opacity-75 text-ellipsis\">by {{ item.data?.creator?.nickname }}</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <CommonModal v-model:visible=\"modalVisible\" @confirm=\"okCollection\">\r\n            <div class=\"text-center fs-5\">确定不再收藏该视频？</div>\r\n        </CommonModal>\r\n    </div>\r\n    <CommonToast ref=\"commonToast\" />\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent, reactive, toRefs } from \"vue\";\r\nimport { useRoute } from \"vue-router\";\r\nimport {\r\n    getVideoDetailApi,\r\n    getVideoUrlApi,\r\n    getLikedMVApi,\r\n    likeMVApi,\r\n    getCollectedMVApi,\r\n    collectVideoApi,\r\n    getVideoDetailInfoApi,\r\n    getRecommendVideoApi,\r\n} from \"@/api/video\";\r\nimport { getUserFollowsApi } from \"@/api/login\";\r\nimport { followUserApi } from \"@/api/common\";\r\nimport { AxiosResponseProps } from \"@/utils/request\";\r\nimport { playCount, YYYYMMDD, playTime } from \"@/hooks/useFilters\";\r\nexport default defineComponent({\r\n    setup() {\r\n        const route = useRoute();\r\n        const state = reactive({\r\n            videoId: route.query.videoId,\r\n            videoDetail: {},\r\n            videoUrls: [],\r\n            commonToast: null,\r\n            userFollows: [],\r\n            likedMVList: [],\r\n            modalVisible: false,\r\n            collectedMVList: [],\r\n            videoDetailInfo: {},\r\n            recommendVideoList: [],\r\n        });\r\n        const getVideoDetail = () => {\r\n            return new Promise((resolve, reject) => {\r\n                getVideoDetailApi({ id: state.videoId }).then(async (res: AxiosResponseProps) => {\r\n                    if (res.code === 200) {\r\n                        state.videoDetail = res.data;\r\n                        await getVideoDetailInfo(res.data.vid);\r\n                        resolve(null);\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        getVideoDetail();\r\n        const getVideoUrl = () => {\r\n            getVideoUrlApi({ id: state.videoId }).then((res: any) => {\r\n                if (res.code === 200) {\r\n                    state.videoUrls = res.urls;\r\n                }\r\n            });\r\n        };\r\n        getVideoUrl();\r\n        const getUserFollows = () => {\r\n            return new Promise((resolve, reject) => {\r\n                getUserFollowsApi().then((res: any) => {\r\n                    if (res.code === 200) {\r\n                        state.userFollows = res.follow;\r\n                        resolve(null);\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        getUserFollows();\r\n        const followUser = isFocus => {\r\n            followUserApi({ t: isFocus ? 1 : 0, id: (state.videoDetail as { creator: { userId: number | null } }).creator.userId }).then(\r\n                async (res: AxiosResponseProps) => {\r\n                    if (res.code === 200) {\r\n                        await getUserFollows();\r\n                        state.commonToast.success(isFocus ? \"已关注\" : \"已取消关注\");\r\n                    }\r\n                }\r\n            );\r\n        };\r\n        const getLikedMV = () => {\r\n            return new Promise((resolve, reject) => {\r\n                getLikedMVApi().then((res: AxiosResponseProps) => {\r\n                    if (res.code === 200) {\r\n                        state.likedMVList = res.data.feeds;\r\n                        resolve(null);\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        getLikedMV();\r\n        const likeMV = isLiked => {\r\n            likeMVApi({ id: (state.videoDetail as { vid: string | null }).vid, t: isLiked ? 1 : 0 }).then(async (res: AxiosResponseProps) => {\r\n                if (res.code === 200) {\r\n                    await getLikedMV();\r\n                    await getVideoDetail();\r\n                    state.commonToast.success(isLiked ? \"已赞\" : \"已取消赞\");\r\n                } else {\r\n                    state.commonToast.warn(res.msg);\r\n                }\r\n            });\r\n        };\r\n        const getCollectedMV = () => {\r\n            getCollectedMVApi().then((res: any) => {\r\n                if (res.code === 200) {\r\n                    state.collectedMVList = res.data;\r\n                }\r\n            });\r\n        };\r\n        getCollectedMV();\r\n        const getRecommendVideo = () => {\r\n            getRecommendVideoApi().then((res: AxiosResponseProps) => {\r\n                if (res.code === 200) {\r\n                    state.recommendVideoList = res.datas;\r\n                }\r\n            });\r\n        };\r\n        getRecommendVideo();\r\n        const collectMV = isCollected => {\r\n            if (!isCollected) state.modalVisible = false;\r\n            collectVideoApi({ t: isCollected ? 1 : 0, id: (state.videoDetail as { vid: string | null }).vid }).then(\r\n                async (res: AxiosResponseProps) => {\r\n                    if (res.code === 200) {\r\n                        await getCollectedMV();\r\n                        await getVideoDetail();\r\n                        state.commonToast.success(isCollected ? \"已收藏\" : \"已取消收藏\");\r\n                    }\r\n                }\r\n            );\r\n        };\r\n        const getVideoDetailInfo = vid => {\r\n            return new Promise((resolve, reject) => {\r\n                getVideoDetailInfoApi({ vid }).then((res: AxiosResponseProps) => {\r\n                    if (res.code === 200) {\r\n                        state.videoDetailInfo = res;\r\n                        resolve(null);\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        return {\r\n            ...toRefs(state),\r\n            followUser,\r\n            playCount,\r\n            YYYYMMDD,\r\n            playTime,\r\n            likeMV,\r\n            collectMV,\r\n        };\r\n    },\r\n});\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.leftArea {\r\n    width: calc(21 * 29px);\r\n    box-sizing: content-box;\r\n    video {\r\n        background-color: #000000;\r\n        width: calc(21 * 29px);\r\n        height: calc(12 * 29px);\r\n    }\r\n    .videoAvatar {\r\n        width: 48px;\r\n        height: 48px;\r\n        background-size: cover;\r\n        background-repeat: no-repeat;\r\n    }\r\n    .haveFocus {\r\n        background-color: rgb(231, 231, 231);\r\n    }\r\n    .groupTag {\r\n        background-color: rgb(238, 238, 238);\r\n        padding: 2px 0;\r\n        margin-bottom: 8px;\r\n    }\r\n    .groupTag ~ .groupTag {\r\n        margin-left: 8px;\r\n    }\r\n    .opBtn {\r\n        &:hover {\r\n            background-color: rgba($color: #cccccc, $alpha: 0.12);\r\n        }\r\n    }\r\n    .opBtn ~ .opBtn {\r\n        margin-left: 8px;\r\n    }\r\n}\r\n.rightArea {\r\n    .recVideoCover {\r\n        width: 140px;\r\n        height: 80px;\r\n    }\r\n    .recVideoInfo{\r\n        width: 140px;\r\n        >div:first-child{\r\n            @include ellipsis(2);\r\n        }\r\n    }\r\n}\r\n.primaryTheme {\r\n    .focus {\r\n        color: $primary !important;\r\n        background-color: rgba($color: $primary, $alpha: 0.15);\r\n    }\r\n}\r\n.darkTheme {\r\n    .focus {\r\n        color: $dark !important;\r\n        background-color: rgba($color: $dark, $alpha: 0.15);\r\n    }\r\n}\r\n.freeTheme {\r\n    .focus {\r\n        color: $free !important;\r\n        background-color: rgba($color: $free, $alpha: 0.15);\r\n    }\r\n}\r\n</style>\r\n","import axiosIns from \"@/utils/request\";\r\n\r\nexport const followUserApi = (params?: { id: string | number; t: number }) => {\r\n    //t : 1为关注,其他为取消关注\r\n    return axiosIns.get(\"/follow\", { params: { ...params, timeStamp: Date.now() } });\r\n};\r\n","\r\nimport { defineComponent, reactive, toRefs } from \"vue\";\r\nimport { useRoute } from \"vue-router\";\r\nimport {\r\n    getVideoDetailApi,\r\n    getVideoUrlApi,\r\n    getLikedMVApi,\r\n    likeMVApi,\r\n    getCollectedMVApi,\r\n    collectVideoApi,\r\n    getVideoDetailInfoApi,\r\n    getRecommendVideoApi,\r\n} from \"@/api/video\";\r\nimport { getUserFollowsApi } from \"@/api/login\";\r\nimport { followUserApi } from \"@/api/common\";\r\nimport { AxiosResponseProps } from \"@/utils/request\";\r\nimport { playCount, YYYYMMDD, playTime } from \"@/hooks/useFilters\";\r\nexport default defineComponent({\r\n    setup() {\r\n        const route = useRoute();\r\n        const state = reactive({\r\n            videoId: route.query.videoId,\r\n            videoDetail: {},\r\n            videoUrls: [],\r\n            commonToast: null,\r\n            userFollows: [],\r\n            likedMVList: [],\r\n            modalVisible: false,\r\n            collectedMVList: [],\r\n            videoDetailInfo: {},\r\n            recommendVideoList: [],\r\n        });\r\n        const getVideoDetail = () => {\r\n            return new Promise((resolve, reject) => {\r\n                getVideoDetailApi({ id: state.videoId }).then(async (res: AxiosResponseProps) => {\r\n                    if (res.code === 200) {\r\n                        state.videoDetail = res.data;\r\n                        await getVideoDetailInfo(res.data.vid);\r\n                        resolve(null);\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        getVideoDetail();\r\n        const getVideoUrl = () => {\r\n            getVideoUrlApi({ id: state.videoId }).then((res: any) => {\r\n                if (res.code === 200) {\r\n                    state.videoUrls = res.urls;\r\n                }\r\n            });\r\n        };\r\n        getVideoUrl();\r\n        const getUserFollows = () => {\r\n            return new Promise((resolve, reject) => {\r\n                getUserFollowsApi().then((res: any) => {\r\n                    if (res.code === 200) {\r\n                        state.userFollows = res.follow;\r\n                        resolve(null);\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        getUserFollows();\r\n        const followUser = isFocus => {\r\n            followUserApi({ t: isFocus ? 1 : 0, id: (state.videoDetail as { creator: { userId: number | null } }).creator.userId }).then(\r\n                async (res: AxiosResponseProps) => {\r\n                    if (res.code === 200) {\r\n                        await getUserFollows();\r\n                        state.commonToast.success(isFocus ? \"已关注\" : \"已取消关注\");\r\n                    }\r\n                }\r\n            );\r\n        };\r\n        const getLikedMV = () => {\r\n            return new Promise((resolve, reject) => {\r\n                getLikedMVApi().then((res: AxiosResponseProps) => {\r\n                    if (res.code === 200) {\r\n                        state.likedMVList = res.data.feeds;\r\n                        resolve(null);\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        getLikedMV();\r\n        const likeMV = isLiked => {\r\n            likeMVApi({ id: (state.videoDetail as { vid: string | null }).vid, t: isLiked ? 1 : 0 }).then(async (res: AxiosResponseProps) => {\r\n                if (res.code === 200) {\r\n                    await getLikedMV();\r\n                    await getVideoDetail();\r\n                    state.commonToast.success(isLiked ? \"已赞\" : \"已取消赞\");\r\n                } else {\r\n                    state.commonToast.warn(res.msg);\r\n                }\r\n            });\r\n        };\r\n        const getCollectedMV = () => {\r\n            getCollectedMVApi().then((res: any) => {\r\n                if (res.code === 200) {\r\n                    state.collectedMVList = res.data;\r\n                }\r\n            });\r\n        };\r\n        getCollectedMV();\r\n        const getRecommendVideo = () => {\r\n            getRecommendVideoApi().then((res: AxiosResponseProps) => {\r\n                if (res.code === 200) {\r\n                    state.recommendVideoList = res.datas;\r\n                }\r\n            });\r\n        };\r\n        getRecommendVideo();\r\n        const collectMV = isCollected => {\r\n            if (!isCollected) state.modalVisible = false;\r\n            collectVideoApi({ t: isCollected ? 1 : 0, id: (state.videoDetail as { vid: string | null }).vid }).then(\r\n                async (res: AxiosResponseProps) => {\r\n                    if (res.code === 200) {\r\n                        await getCollectedMV();\r\n                        await getVideoDetail();\r\n                        state.commonToast.success(isCollected ? \"已收藏\" : \"已取消收藏\");\r\n                    }\r\n                }\r\n            );\r\n        };\r\n        const getVideoDetailInfo = vid => {\r\n            return new Promise((resolve, reject) => {\r\n                getVideoDetailInfoApi({ vid }).then((res: AxiosResponseProps) => {\r\n                    if (res.code === 200) {\r\n                        state.videoDetailInfo = res;\r\n                        resolve(null);\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        return {\r\n            ...toRefs(state),\r\n            followUser,\r\n            playCount,\r\n            YYYYMMDD,\r\n            playTime,\r\n            likeMV,\r\n            collectMV,\r\n        };\r\n    },\r\n});\r\n","import { render } from \"./videoDetail.vue?vue&type=template&id=6925c038&scoped=true\"\nimport script from \"./videoDetail.vue?vue&type=script&lang=ts\"\nexport * from \"./videoDetail.vue?vue&type=script&lang=ts\"\n\nimport \"./videoDetail.vue?vue&type=style&index=0&id=6925c038&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-6925c038\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./videoDetail.vue?vue&type=style&index=0&id=6925c038&scoped=true&lang=scss\""],"sourceRoot":""}